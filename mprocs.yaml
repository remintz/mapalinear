procs:
  postgres:
    cmd: ["bash", "-c", "docker start -a mapalinear-postgres 2>/dev/null || docker run --name mapalinear-postgres -e POSTGRES_PASSWORD=postgres -e POSTGRES_USER=postgres -v mapalinear-pgdata:/var/lib/postgresql/data -p 5432:5432 postgres:16"]
    cwd: .
    autostart: true
    color: magenta
    stop_signal: SIGTERM
    stop_timeout: 5

  api:
    cmd: ["poetry", "run", "python", "-m", "api.run"]
    env:
      MAPALINEAR_HOST: "0.0.0.0"
      MAPALINEAR_PORT: "8001"
    cwd: .
    autostart: true
    color: green
    stop_signal: SIGTERM
    stop_timeout: 5

  frontend:
    cmd: ["npm", "run", "dev", "--", "--port", "8000"]
    env:
      NEXT_PUBLIC_API_URL: "http://localhost:8001/api"
    cwd: ./frontend
    autostart: true
    color: blue
    stop_signal: SIGTERM
    stop_timeout: 3